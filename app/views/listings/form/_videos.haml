= label_tag 'Video'
.flash-notifications.js-listing-image-loading.hidden#video_flash
  .flash-notification{:class => "flash-notice"}
    .flash-icon{:class => icon_class("loading")}
    .flash-text
      = t("listings.form.images.video_uploading_in_progress")

= s3_uploader_form id: "s3-uploader" do
  .listing-images
    #video_upload.fileinput-button.upload-image-placeholder
      .fileupload-text-container{:style => ""}
        .fileupload-centered-text
          .fileupload-text Select file
          .fileupload-small-text
          .fileupload-error-text
      %img.fileupload-preview-image{:style => "display: none;"}
      .fileupload-preview-remove-image
        %i.icon-remove.icon-fix
      = file_field_tag :file, multiple: true
    #video_upload.fileinput-button.upload-image-placeholder
      .fileupload-text-container{:style => ""}
        .fileupload-centered-text
          .fileupload-text Select file
          .fileupload-small-text
          .fileupload-error-text
      %img.fileupload-preview-image{:style => "display: none;"}
      .fileupload-preview-remove-image
        %i.icon-remove.icon-fix
      = file_field_tag :file, multiple: true
    #video_upload.fileinput-button.upload-image-placeholder
      .fileupload-text-container{:style => ""}
        .fileupload-centered-text
          .fileupload-text Select file
          .fileupload-small-text
          .fileupload-error-text
      %img.fileupload-preview-image{:style => "display: none;"}
      .fileupload-preview-remove-image
        %i.icon-remove.icon-fix
      = file_field_tag :file, multiple: true

- content_for :videos_js do
  :javascript
    $(function() {
      $("#submit_listing_btn").click(function(){
        $('.listing_form').submit();
      })
      $("#s3-uploader").S3Uploader();
      $('#s3-uploader').bind("s3_uploads_start", function(e, content) {
        $('#video_flash').show()
      });
      $('#s3-uploader').bind("s3_upload_complete", function(e, content) {
        console.log(content.url)
        $('#video_flash').hide()
      });
    });

- if run_js_immediately
  = yield :videos_js
- else
  - content_for :extra_javascript do
    = yield :videos_js
  